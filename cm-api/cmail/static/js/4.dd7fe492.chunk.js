(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{488:function(e,t,a){"use strict";a.r(t);var n=a(29),r=a(12),l=a(13),c=a(14),s=a(8),o=a(15),i=a(2),m=a.n(i),d=a(10),u=(a(20),a(28)),p=a(464),h=a(465),E=a(31),f=a(5),b=a.n(f),g={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6","display-1":"h1","display-2":"h1","display-3":"h1","display-4":"h1",p:"p",lead:"p",blockquote:"blockquote"},v=function(e){var t,a=e.tag,n=e.className,r=e.type,l=Object(d.a)(e,["tag","className","type"]),c=b()(Object(E.a)({},r,!!r),n);return t=a||(!a&&g[r]?g[r]:"p"),m.a.createElement(t,Object.assign({},l,{className:c}))};v.defaultProps={type:"p"};var w=v,y=u.a.create("page"),k=function(e){var t=e.title,a=e.breadcrumbs,n=e.tag,r=e.className,l=e.children,c=Object(d.a)(e,["title","breadcrumbs","tag","className","children"]),s=y.b("px-3",r);return m.a.createElement(n,Object.assign({className:s},c),m.a.createElement("div",{className:y.e("header")},t&&"string"===typeof t?m.a.createElement(w,{type:"h1",className:y.e("title")},t):t,a&&m.a.createElement(p.a,{className:y.e("breadcrumb")},m.a.createElement(h.a,null,"Home"),a.length&&a.map(function(e,t){var a=e.name,n=e.active;return m.a.createElement(h.a,{key:t,active:n},a)}))),l)};k.defaultProps={tag:"div",title:""};var S=k,j=a(268),C=a(172),O=a(473),x=a(165),N=a(478),B=a(479),F=a(480),A=a(471),D=(a(466),a(486)),M=a(470),I=(a(492),a(474)),T=a(475),P=a(477),R=a(489),z=a(472),_=a(494),H=a(481),J=a(482),L=a(30);function V(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}var W=Object(O.a)(function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(x.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}}),U=function(e){var t=W(),a=e.numSelected,n=e.tableTitle,r=void 0!=n?n.toLowerCase():"";return m.a.createElement(I.a,{className:Object(C.default)(t.root,Object(E.a)({},t.highlight,a>0))},m.a.createElement("div",{className:t.title},a>0?m.a.createElement(T.a,{color:"inherit"},a," selected"):m.a.createElement(T.a,{id:"tableTitle"},n)),m.a.createElement("div",{className:t.spacer}),m.a.createElement("div",{className:t.actions},a>0&&m.a.createElement(m.a.Fragment,null,null===r.match("spam")?m.a.createElement(_.a,{title:"Mark as spam"},m.a.createElement(z.a,{"aria-label":"spam",onClick:function(){e.unselectAll(),e.spamEmails(e.rows)}},m.a.createElement(L.b,null))):m.a.createElement(_.a,{title:"Not Spam"},m.a.createElement(z.a,{"aria-label":"unspam",onClick:function(){e.unselectAll(),e.unspamEmails(e.rows)}},m.a.createElement(L.e,null))),null===r.match("trash")?m.a.createElement(_.a,{title:"Move to trash"},m.a.createElement(z.a,{"aria-label":"delete",onClick:function(){e.unselectAll(),e.trashEmails(e.rows)}},m.a.createElement(L.l,null))):m.a.createElement(m.a.Fragment,null,m.a.createElement(_.a,{title:"Delete emails"},m.a.createElement(z.a,{"aria-label":"delete",onClick:function(){e.unselectAll(),e.trashEmails(e.rows)}},m.a.createElement(L.l,null))),m.a.createElement(_.a,{title:"Restore emails"},m.a.createElement(z.a,{"aria-label":"undelete",onClick:function(){e.unselectAll(),e.untrashEmails(e.rows)}},m.a.createElement(L.m,null)))))))},q=Object(O.a)(function(e){return{root:{width:"100%"},paper:{width:"100%"},table:{minWidth:750},tableWrapper:{overflowX:"auto"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}),Y=m.a.memo(function(e){var t=e.rows,a=e.headCells,n=e.tableTitle,r=e.labelRowsPerPage,l=e.showEmptyRows,c=(e.props,e.showEmail),s=e.trashEmail,o=e.starEmail,d=e.untrashEmail,u=e.spamEmail,p=e.unspamEmail,h=e.breakpoint,E=q(),f=m.a.useState("desc"),b=Object(j.a)(f,2),g=b[0],v=(b[1],m.a.useState("id")),w=Object(j.a)(v,2),y=w[0],k=(w[1],m.a.useState([])),S=Object(j.a)(k,2),C=S[0],O=S[1],x=m.a.useState(0),I=Object(j.a)(x,2),T=I[0],z=I[1],_=m.a.useState(!1),L=Object(j.a)(_,2),W=L[0],Y=L[1],X=m.a.useState(30),G=Object(j.a)(X,2),K=G[0],Q=G[1];r=r||"Per page",l="undefined"==typeof l||l;var Z=function(e,t){c(t)},$=function(e,t){var a=C.indexOf(t),n=[];-1===a?n=n.concat(C,t):0===a?n=n.concat(C.slice(1)):a===C.length-1?n=n.concat(C.slice(0,-1)):a>0&&(n=n.concat(C.slice(0,a),C.slice(a+1))),O(n)},ee=function(e,t){e.preventDefault();var a=document.querySelector("#star-"+t).getAttribute("data-starred");o(t,"1"===a?0:1)},te=function(e,t){z(t)},ae=function(e){Q(+e.target.value),z(0)},ne=K-Math.min(K,t.length-T*K);return Object(i.useEffect)(function(){"xs"===h&&Y(!0)}),m.a.createElement("div",{className:E.root},m.a.createElement(P.a,{className:E.paper},m.a.createElement(N.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",spacing:0,className:E.root,style:{borderBottom:"1px solid inherit"}},m.a.createElement(N.a,{item:!0,xs:!0,style:{paddingLeft:4}},m.a.createElement(R.a,{indeterminate:C.length>0&&C.length<t.length,checked:C.length===t.length,onChange:function(e){if(e.target.checked){var a=t.map(function(e){return e.id});O(a)}else O([])},inputProps:{"aria-label":"select all"}})),m.a.createElement(N.a,{item:!0,xs:!0},m.a.createElement(U,{numSelected:C.length,tableTitle:n,rows:C,trashEmails:s,unselectAll:function(e){O([])},untrashEmails:d,spamEmails:u,unspamEmails:p})),m.a.createElement(N.a,{item:!0,xs:!0},m.a.createElement(D.a,{rowsPerPageOptions:[30,50,100],labelRowsPerPage:r,component:"div",count:t.length,rowsPerPage:K,page:T,backIconButtonProps:{"aria-label":"previous page"},nextIconButtonProps:{"aria-label":"next page"},onChangePage:te,onChangeRowsPerPage:ae}))),m.a.createElement("div",{className:E.tableWrapper},m.a.createElement(B.a,{className:E.table,"aria-labelledby":"tableTitle",size:W?"small":"medium",striped:!0},m.a.createElement(F.a,null,function(e,t){var a=e.map(function(e,t){return[e,t]});return a.sort(function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]}),a.map(function(e){return e[0]})}(t,function(e,t){return"desc"===e?function(e,a){return V(e,a,t)}:function(e,a){return-V(e,a,t)}}(g,y)).slice(T*K,T*K+K).map(function(e,t){var a,n=(a=e.id,-1!==C.indexOf(a)),r="enhanced-table-checkbox-".concat(t);return"xs"===h?m.a.createElement(m.a.Fragment,null,m.a.createElement(M.a,{hover:!0,role:"checkbox","aria-checked":n,tabIndex:-1,key:e.id,selected:n,className:"hl-tr"},m.a.createElement(A.a,{padding:"checkbox",onClick:function(t){return $(0,e.id)},rowSpan:5},m.a.createElement(R.a,{checked:n,inputProps:{"aria-labelledby":r}}))),Object.keys(e).map(function(t,a){if("id"!==t){if("starred"===t){var n=m.a.createElement(A.a,null,m.a.createElement("span",{id:"star-"+e.id,onClick:function(t){return ee(t,e.id)},"data-starred":e[t],className:"starred"},1===e[t]?"\u2605":"\u2606"));return m.a.createElement(M.a,null,n)}if("subject"===t){var r=m.a.createElement(A.a,{onClick:function(t){return Z(0,e.id)}},e[t].substr(0,30),"...");return m.a.createElement(M.a,null,r)}if("attachment"!==t){if("timestamp"===t){var l=e[t].split(" ");l=l[0];var c=m.a.createElement(A.a,{onClick:function(t){return Z(0,e.id)}},l);return m.a.createElement(M.a,null,c)}var s=m.a.createElement(A.a,{onClick:function(t){return Z(0,e.id)}},m.a.createElement("strong",null,e[t]));return m.a.createElement(M.a,null,s)}}return null})):m.a.createElement(M.a,{hover:!0,role:"checkbox","aria-checked":n,tabIndex:-1,key:e.id,selected:n,className:"hl-tr"},m.a.createElement(A.a,{padding:"checkbox",onClick:function(t){return $(0,e.id)},rowSpan:1},m.a.createElement(R.a,{checked:n,inputProps:{"aria-labelledby":r}})),Object.keys(e).map(function(t,a){if("id"!==t){if("starred"===t)return m.a.createElement(A.a,null,m.a.createElement("span",{id:"star-"+e.id,onClick:function(t){return ee(t,e.id)},"data-starred":e[t],className:"starred"},1===e[t]?"\u2605":"\u2606"));if("subject"===t)return m.a.createElement(A.a,{onClick:function(t){return Z(0,e.id)}},e[t].substr(0,40),"...");if("attachment"!==t){if("timestamp"===t){var n=e[t];return m.a.createElement(A.a,{onClick:function(t){return Z(0,e.id)}},n)}return m.a.createElement(A.a,{onClick:function(t){return Z(0,e.id)}},e[t])}}return null}))}),ne>0&&l&&m.a.createElement(M.a,{key:"t1",style:{height:(W?33:53)*ne}},m.a.createElement(A.a,{colSpan:a.length+1}))))),m.a.createElement(D.a,{rowsPerPageOptions:[30,50,100],labelRowsPerPage:r,component:"div",count:t.length,rowsPerPage:K,page:T,backIconButtonProps:{"aria-label":"previous page"},nextIconButtonProps:{"aria-label":"next page"},onChangePage:te,onChangeRowsPerPage:ae})),m.a.createElement(H.a,{control:m.a.createElement(J.a,{checked:W,onChange:function(e){Y(e.target.checked)}}),label:"Dense padding"}))}),X=a(23),G=a.n(X),K=a(142),Q=a(118),Z=a(279),$=a(137),ee=a(123),te=a(117),ae=a(27),ne=(a(42),a(269)),re=a(153),le=a(261),ce=a.n(le),se=(a(262),a(138)),oe=a(112),ie=a(113),me=a(115),de=a(483),ue=a(114),pe=a(491),he=a(484),Ee=a(16),fe=a(373),be=a.n(fe),ge=a(384),ve=a.n(ge),we=(a(405),a(406)),ye=a.n(we),ke=(a(409),a(263));function Se(e){return function(){var t,a=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var n=Object(s.a)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return Object(c.a)(this,t)}}var je=function(e){Object(o.a)(a,e);var t=Se(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(e=t.call.apply(t,[this].concat(l))).onWindowClick=function(){return e.props.onOverrideContent(void 0)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){window.addEventListener("click",e.onWindowClick)})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.onWindowClick)}},{key:"render",value:function(){var e=this,t=[ke.HeadlineOneButton,ke.HeadlineTwoButton,ke.HeadlineThreeButton];return m.a.createElement("div",null,t.map(function(t,a){return m.a.createElement(t,Object.assign({key:a},e.props))}))}}]),a}(i.Component),Ce=function(e){Object(o.a)(a,e);var t=Se(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(e=t.call.apply(t,[this].concat(l))).onClick=function(){return e.props.onOverrideContent(je)},e}return Object(l.a)(a,[{key:"render",value:function(){return m.a.createElement("div",{className:"headlineButtonWrapper"},m.a.createElement("button",{onClick:this.onClick,className:"headlineButton"},"H"))}}]),a}(i.Component),Oe=ve()(),xe=Oe.Toolbar,Ne=ye()(),Be=Ne.UndoButton,Fe=Ne.RedoButton,Ae=[Oe,Ne],De=function(e){Object(o.a)(a,e);var t=Se(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(e=t.call.apply(t,[this].concat(l))).focus=function(){e.editor.focus()},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return m.a.createElement("div",null,m.a.createElement("div",{className:"editor",onClick:this.focus},m.a.createElement(be.a,{editorState:this.props.editorState,onChange:this.props.onEditorStateChange,plugins:Ae,ref:function(t){e.editor=t}}),m.a.createElement(xe,null,function(e){return m.a.createElement("div",null,m.a.createElement(Be,Object.assign({},e,{className:"cm-w-30p cm-h-30p"})),m.a.createElement(Fe,Object.assign({},e,{className:"cm-w-30p cm-h-30p"})),m.a.createElement(ge.Separator,e),m.a.createElement(ke.BoldButton,e),m.a.createElement(ke.ItalicButton,e),m.a.createElement(ke.UnderlineButton,e),m.a.createElement(ge.Separator,e),m.a.createElement(Ce,e),m.a.createElement(ke.UnorderedListButton,e),m.a.createElement(ke.OrderedListButton,e),m.a.createElement(ke.BlockquoteButton,e))})))}}]),a}(i.Component),Me=a(410),Ie=a.n(Me),Te=a(417),Pe=a(415),Re={position:"fixed",zIndex:1,boxShadow:"0 0 4px rgba(0, 0, 0, 0.3)",background:"white",left:Pe.isMobile?"10px":"unset",top:"unset",width:Pe.isMobile?"90%":"40%",height:Pe.isMobile?"100%":"70%",right:"10px",bottom:"5px","border-radius":"15px 15px 0px 0px",overflow:"hidden"},ze={position:"fixed",zIndex:1,boxShadow:"0 0 4px rgba(0, 0, 0, 0.3)",background:"white",left:"unset",top:"unset",width:"25%",height:"10%",right:"10px",bottom:"5px","border-radius":"15px 15px 0px 0px",overflow:"hidden"},_e=function(e){var t,a,n=Object(i.useState)(0),r=Object(j.a)(n,2),l=(r[0],r[1],e.dockState),c="",s=!1;"maximize"===l?(t=8,a=4):"minimize"===l?(t=7,a=5,c="d-none",Pe.isMobile&&(s=!0)):(t=9,a=3),Object(i.useEffect)(function(){e.attachmentContent&&(document.getElementById("attachment").files=e.attachmentContent)});var o=m.a.createElement("div",{className:c},m.a.createElement($.a,{className:"bg-secondary text-white ml-0 mr-0 cm-h-30p cm-sticky-header"},m.a.createElement(se.a,{md:t,sm:t,xs:t,className:"mt-1 mb-1"},m.a.createElement("div",{className:"ml-2"}," New Email ")),m.a.createElement(se.a,{md:a,sm:a,xs:a,className:"mt-1 mb-0"},m.a.createElement($.a,{className:"ml-0 mr-0"},m.a.createElement(se.a,{md:"4",sm:"4",xs:"4"},m.a.createElement(L.h,{className:"cm-pointer",onClick:function(){"minimize"===l?e.resizeDock("normal"):e.resizeDock("minimize")},hidden:s})),m.a.createElement(se.a,{md:"4",sm:"4",xs:"4"},m.a.createElement(L.n,{className:"cm-pointer",onClick:function(){"maximize"===l?e.resizeDock("normal"):e.resizeDock("maximize")},hidden:s})),m.a.createElement(se.a,{md:"4",sm:"4",xs:"4"},m.a.createElement("span",{className:"font-weight-bold cm-pointer",onClick:function(){e.closemodal()}}," X "))))),m.a.createElement(oe.a,{onSubmit:function(){e.sendemail()},className:"m-1"},m.a.createElement(ie.a,null,m.a.createElement(me.a,{type:"text",name:"to",id:"to",placeholder:"To:",className:"cm-h-30p",defaultValue:e.to,required:!0}),m.a.createElement(me.a,{type:"text",name:"text",id:"cc",placeholder:"CC:",className:"cm-h-30p mt-1",defaultValue:e.cc}),m.a.createElement(me.a,{type:"text",name:"bcc",id:"bcc",placeholder:"Bcc:",className:"cm-h-30p mt-1",defaultValue:e.bcc}),m.a.createElement(de.a,{color:"muted"}," Email addresses to be separated by ,"),m.a.createElement(me.a,{type:"text",name:"subject",id:"subject",placeholder:"Subject of the email",className:"cm-h-30p mt-1",defaultValue:e.subject})),m.a.createElement(ie.a,null,m.a.createElement(De,{id:"email",editorState:e.meditorstate,content:e.content,onEditorStateChange:function(t){e.meditorstatehandler(t)}})),m.a.createElement(ie.a,null,m.a.createElement(te.a,{onClick:function(){return e.sendemail()}},"Send ",m.a.createElement(Te.a,null)),m.a.createElement(ue.a,{for:"attachment",className:"float-right"},m.a.createElement(Ee.a,null)),m.a.createElement(me.a,{type:"file",name:"attachment",id:"attachment",multiple:"multiple",onChange:function(t){e.attachmenthandler(t)},hidden:!0}))));return"maximize"===l?m.a.createElement(pe.a,{isOpen:e.modal,toggle:function(){e.closemodal()},className:e.classnm},m.a.createElement(he.a,null,o)):"minimize"===l?m.a.createElement(Ie.a,{position:"bottom",isVisible:e.modal,dimMode:"none",fluid:!0,size:"0.1",dockStyle:ze},o):m.a.createElement(Ie.a,{position:"bottom",isVisible:e.modal,dimMode:"none",fluid:!0,size:"0.82",dockStyle:Re},o)},He=a(128),Je=a(135),Le=a(124),Ve=a(426),We=a(427);function Ue(e){return function(){var t,a=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var n=Object(s.a)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return Object(c.a)(this,t)}}var qe=function(e){Object(o.a)(a,e);var t=Ue(a);function a(e){var n;Object(r.a)(this,a),(n=t.call(this,e)).state={editorState:re.EditorState.createEmpty(),isCc:!1,isBcc:!1},n.onEditorStateChange=function(e){n.setState({editorState:e})};var l={};if(n.props.markdown){var c=n.props.fwdMsg,s=Object(ne.b)(c);l=Object(re.convertFromRaw)(s)}else l=Object(We.a)(n.props.fwdMsg);var o=re.EditorState.createWithContent(l);return n.state={editorState:o},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){!0===this.props.isEmailFwd&&(document.getElementById("staticEmail").value="",this.state.isCc&&(document.getElementById("cc").value=""),this.state.isBcc&&(document.getElementById("bcc").value="")),this.props.orCc.length>0&&!1===this.state.isCc&&this.setState({isCc:!0}),this.props.orBcc.length>0&&!1===this.state.isBcc&&this.setState({isBcc:!0})}},{key:"render",value:function(){var e=this,t=this.state.editorState;return m.a.createElement("div",null,m.a.createElement("div",null,m.a.createElement(oe.a,null,m.a.createElement(ie.a,{row:!0},m.a.createElement(ue.a,{for:"staticEmail",sm:2},"To"),m.a.createElement(se.a,{sm:10},m.a.createElement(me.a,{type:"text",className:"form-control-plaintext border-bottom",id:"staticEmail",defaultValue:this.props.orFrom,placeholder:"To"}),m.a.createElement(de.a,{color:"muted"}," Email addresses to be separated by ,"))),this.state.isCc?m.a.createElement(ie.a,{row:!0},m.a.createElement(ue.a,{for:"cc",sm:2},"Cc"),m.a.createElement(se.a,{sm:10},m.a.createElement(me.a,{type:"text",className:"form-control-plaintext border-bottom",id:"cc",placeholder:"Cc",defaultValue:this.props.isEmailFwd?"":this.props.orCc}),m.a.createElement(de.a,{color:"muted"}," Email addresses to be separated by ,"))):m.a.createElement("a",{href:"#cc",onClick:function(){e.setState({isCc:!0})}},"CC"),m.a.createElement("span",null,"\xa0"),this.state.isBcc?m.a.createElement(ie.a,{row:!0},m.a.createElement(ue.a,{for:"bcc",sm:2},"Bcc"),m.a.createElement(se.a,{sm:10},m.a.createElement(me.a,{label:"Bcc",type:"text",className:"form-control-plaintext border-bottom",id:"bcc",placeholder:"Bcc",defaultValue:this.props.isEmailFwd?"":this.props.orBcc}),m.a.createElement(de.a,{color:"muted"}," Email addresses to be separated by ,"))):m.a.createElement("a",{href:"#bcc",onClick:function(){e.setState({isBcc:!0})}},"BCC"),m.a.createElement(ie.a,{row:!0},m.a.createElement(ue.a,{for:"subject",sm:2},"Subject"),m.a.createElement(se.a,{sm:10},m.a.createElement(me.a,{type:"text",label:"subject",className:"form-control-plaintext border-bottom",id:"subject",placeholder:"Subject",defaultValue:this.props.isEmailFwd?"Fwd: "+this.props.subject:"Re: "+this.props.subject}))))),m.a.createElement("span",null,"\xa0"),m.a.createElement(Ve.Editor,{editorState:t,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:this.onEditorStateChange,placeholder:"Type your mail here...",toolbarClassName:"toolbar-class",toolbar:{inline:{inDropdown:!0},list:{inDropdown:!0},textAlign:{inDropdown:!0},link:{inDropdown:!0},history:{inDropdown:!0}}}),m.a.createElement("div",null,"  ",m.a.createElement(Ee.a,null)," \xa0 ",m.a.createElement("input",{type:"file",name:"attachment",id:"attachment",multiple:!0,onChange:function(t){e.props.handleAttachment(t)}}),m.a.createElement("p",{className:"text-muted"},"Maximum allowed file size 20MB")),m.a.createElement(te.a,{className:"mr-2",onClick:function(){var a={},n=t.getCurrentContent();a=e.props.markdown?Object(ne.a)(Object(re.convertToRaw)(n)):ce()(Object(re.convertToRaw)(n)),e.props.replyEmail(a)}},"Send"),m.a.createElement(te.a,{onClick:function(){document.getElementById("attachment").value="",e.props.editor(),e.props.resetSubject(),e.props.closeEditors()}},m.a.createElement(L.l,null)))}}]),a}(i.Component),Ye=function(e){var t="float-right";return"xs"===e.breakpoint&&(t="float-left i-block"),m.a.createElement($.a,{className:"email-pg"},m.a.createElement(se.a,{xl:9,lg:9,md:9,xs:9},e.thread.map(function(a,n){var r=a.body;if(1===a.hasAttachments){r+="<hr><p>Attachments:</p><ul>";for(var l=window.location.pathname,c=l.split("/"),s=c.pop();"cmail"!==s;)s=c.pop();l=c.join("/");for(var o=0;o<a.attachment.length;o++)r+="<li><a href='"+l+a.attachment[o].url+"' target='_blank' download>"+a.attachment[o].file+"</a></li>";r+="</ul>"}return m.a.createElement(m.a.Fragment,{key:a.uid},m.a.createElement(ee.a,{className:"mt-3"},m.a.createElement(He.a,null,m.a.createElement("div",{className:"clearfix"},m.a.createElement(Je.a,{to:"#url",title:"Back to mailbox",onClick:function(t){t.preventDefault(),e.setState({page:"list"}),e.fetchEmails()},className:"email-icons float-left"},m.a.createElement(L.a,null)),m.a.createElement("span",{className:"eml-subject float-left"},a.subject),m.a.createElement(Je.a,{to:"#",className:"email-icons ".concat(t),title:"Delete email",onClick:function(t){t.preventDefault();var n=a.uid;e.trashEmail(n),e.setState({page:"list"}),e.fetchEmails()}},m.a.createElement(L.l,null)),m.a.createElement(Je.a,{to:"#",className:"email-icons ".concat(t),title:"Mark email as spam",onClick:function(t){t.preventDefault();var n=a.uid;e.spamEmail(n),e.setState({page:"list"}),e.fetchEmails()}},m.a.createElement(L.b,null)),m.a.createElement(Je.a,{to:"#",title:e.emailStarred?"Unmark as starred":"Mark as starred",onClick:function(t){t.preventDefault();var n=a.uid,r=0;r=1===e.emailStarred?0:1,e.setState({isEmailStarred:r}),e.starEmail(n,r)},className:"email-icons ".concat(t)},e.emailStarred?m.a.createElement(L.i,null):m.a.createElement(L.g,null))),m.a.createElement("div",{className:"clearfix"},m.a.createElement("span",{className:"float-left eml-from"},a.from),m.a.createElement("span",{className:"".concat(t)},e.displayDate(a.date)))),m.a.createElement(Le.a,{dangerouslySetInnerHTML:{__html:"".concat(r)}})),m.a.createElement(ee.a,{className:"mt-3"},m.a.createElement(Le.a,null,m.a.createElement($.a,{className:"editor-container"},a.editor?m.a.createElement(se.a,{xs:"auto"},m.a.createElement(qe,{className:"ql-editor",editor:e.editorHandler,from:a.from,cc:a.cc,bcc:a.bcc,subject:a.subject,replyEmail:e.replyEmail,resetSubject:e.resetSubject,orFrom:a.from,orCc:a.cc,orBcc:a.bcc,to:a.to,orTo:a.to,uid:a.uid,fwdMsg:e.fwdMsg,isEmailFwd:e.isEmailFwd,handleAttachment:function(t){e.handleAttachment(t)},closeEditors:e.closeEditors,markdown:e.markdown})):m.a.createElement($.a,null,m.a.createElement("div",{className:"ml-3"},m.a.createElement(te.a,{className:"ml-3",onClick:function(){e.activeThread(n);var t=a.subject;e.setState({editor:!0,orSubject:t,subject:t,isEmailFwd:!1})}},"Reply")),m.a.createElement("div",{className:"ml-3"},m.a.createElement(te.a,{className:"ml-3",onClick:function(){e.activeThread(n);var t=a.subject;e.setState({editor:!0,orSubject:t,subject:t,isEmailFwd:!0})}},"Forward")))))))})))},Xe=a(485),Ge=function(e){var t=e.markdown;return m.a.createElement($.a,{className:"email-pg"},m.a.createElement(se.a,{xl:9,lg:9,md:9,xs:9},m.a.createElement(ee.a,{className:"mt-3"},m.a.createElement(He.a,null,"Settings"),m.a.createElement(Le.a,null,m.a.createElement(Xe.a,{type:"switch",id:"markdown",name:"markdown",label:"Enable Markdown",onChange:function(e){t=e.target.checked},defaultChecked:e.markdown}),m.a.createElement("br",null),m.a.createElement(te.a,{onClick:function(){e.setState({enableMarkdown:t,page:"list"}),e.fetchEmails()}},"Save")))))};function Ke(e){return function(){var t,a=Object(s.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var n=Object(s.a)(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return Object(c.a)(this,t)}}function Qe(e,t,a,n,r,l,c){return{id:e,starred:t,from:a,subject:n,timestamp:c}}var Ze=[{id:"starred",numeric:!0,disablePadding:!1,label:""},{id:"from",numeric:!1,disablePadding:!1,label:"From"},{id:"subject",numeric:!1,disablePadding:!1,label:"Subject"},{id:"timestamp",numeric:!1,disablePadding:!1,label:"Date"}],$e=function(e){Object(o.a)(a,e);var t=Ke(a);function a(e){var l;return Object(r.a)(this,a),(l=t.call(this,e)).handleAttachment=function(e){var t=e.target.files;l.setState({attachment:t})},l.updateState=function(e){l.setState(Object(n.a)({},e))},l.onModalEditorStateChange=function(e){l.setState({modalEditorState:e})},l.editorHandler=function(){l.setState({editor:!1})},l.resetSubject=function(){l.setState({subject:l.state.orSubject})},l.replyEmail=function(e){var t={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},a=e,n=document.getElementById("cc"),r=document.getElementById("bcc"),c=document.getElementById("staticEmail").value,s=document.getElementById("subject").value,o=l.state.messageId,i={};if(l.state.attachment){i=new FormData;for(var m=0,d=l.state.attachment;m<d.length;m++)i.append("attachment[]",d[m]);i.append("to",c),i.append("subject",s),i.append("body",a),i.append("messageId",o),null!==n&&i.append("cc",n.value),null!==r&&i.append("cc",r.value),t.headers["Content-Type"]="multipart/form-data"}else i={to:c,subject:s,body:a,messageId:o},null!==n&&(i.cc=n.value),null!==r&&(i.bcc=r.value);G.a.post(window._api+"/smtp/sendEmail",i,t).then(function(e){e.data.result>0?(l.editorHandler(),l.setState({attachment:!1}),Object(ae.b)("Email has been sent"),l.resetSubject(),l.closeEditors()):Object(ae.b)(e.data.message)})},l.starEmail=function(e,t){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},n={curFolder:l.props.curFolder,uid:e,emailState:t,trashFolder:"trash",starredFolder:"starred"};G.a.post(window._api+"/star_emails",n,a).then(function(a){if(a.data.result>0){if(0===t?Object(ae.b)("Email moved to Inbox"):Object(ae.b)("Email moved to Starred"),"list"===l.state.page){var n=l.state.rows;n=n.filter(function(t){return t.id!==e}),l.setState({rows:n})}}else 0===t?Object(ae.b)("Email still marked as starred"):Object(ae.b)("Unable to mark email as starred")})}},l.untrashEmail=function(e){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var n=l.state.rows;e.sort();var r=0;n=n.filter(function(t){return t.id!==e[r]||(r++,!1)}),l.setState({rows:n}),e=JSON.stringify(e),t=1}var c={curfolder:"inbox",trash:"trash",uid:e};G.a.post(window._api+"/untrash_emails",c,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails have been restored"):Object(ae.b)("Email has been restored"))})},l.trashEmail=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var n=l.state.rows;e.sort();var r=0;n=n.filter(function(t){return t.id!==e[r]||(r++,!1)}),l.setState({rows:n}),e=JSON.stringify(e),t=1}var c={curfolder:l.props.curFolder,trash:"trash",uid:e};G.a.post(window._api+"/trash_emails",c,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails have been deleted"):Object(ae.b)("Email has been deleted"))})}},l.spamEmail=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var n=l.state.rows;e.sort();var r=0;n=n.filter(function(t){return t.id!==e[r]||(r++,!1)}),l.setState({rows:n}),e=JSON.stringify(e),t=1}var c={curfolder:l.props.curFolder,spam:"spam",uid:e};G.a.post(window._api+"/spam_emails",c,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails marked as spam"):Object(ae.b)("Email marked as spam"))})}},l.unspamEmail=function(e){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var n=l.state.rows;e.sort();var r=0;n=n.filter(function(t){return t.id!==e[r]||(r++,!1)}),l.setState({rows:n}),e=JSON.stringify(e),t=1}var c={curfolder:"inbox",spam:"spam",uid:e};G.a.post(window._api+"/unspam_emails",c,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails have been restored"):Object(ae.b)("Email has been restored"))})},l.sendEmail=function(e){var t={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},a={},n=l.state.modalEditorState.getCurrentContent();a=l.state.enableMarkdown?Object(ne.a)(Object(re.convertToRaw)(n)):ce()(Object(re.convertToRaw)(n));var r=document.getElementById("cc"),c=document.getElementById("bcc"),s=document.getElementById("to").value,o=document.getElementById("subject").value,i={};if(l.state.attachment){var m=0;i=new FormData;for(var d=l.state.attachment;m<d.length;m++)i.append("attachment[]",d[m]);i.append("to",s),i.append("subject",o),i.append("body",a),null!==r&&i.append("cc",r.value),null!==c&&i.append("bcc",c.value),t.headers["Content-Type"]="multipart/form-data"}else i={to:s,subject:o,body:a},null!==r&&(i.cc=r.value),null!==c&&(i.bcc=c.value);G.a.post(window._api+"/smtp/sendEmail",i,t).then(function(e){e.data.result>0?(l.resetFields(),l.setState({modal:!1}),Object(ae.b)("Email has been sent")):Object(ae.b)(e.data.message)})},l.resetFields=function(){document.getElementById("to")&&(document.getElementById("to").value="",document.getElementById("cc").value="",document.getElementById("bcc").value="",document.getElementById("subject").value="",document.getElementById("attachment").value="",l.setState({modalEditorState:re.EditorState.createEmpty(),attachment:!1}))},l.handleCompose=function(e){return function(){e||(l.setState({modal:!l.state.modal}),l.resetFields())}},l.closeModal=function(){l.setState({modal:!1,dockState:"normal"})},l.resizeDock=function(e){var t=document.getElementById("cc").value,a=document.getElementById("bcc").value,n=document.getElementById("to").value,r=document.getElementById("subject").value,c=document.getElementById("attachment").files,s=l.state.modalEditorState.getCurrentContent();l.setState({dockState:e,to:n,cc:t,bcc:a,subject:r,content:s,attachmentContent:c})},l.setEmailNode=function(e){var t="",a="",n="",r="",c="",s="",o="",i="",m="",d="";if(e){t=e.cc,s=e.cc,a=e.bcc,o=e.bcc,n=e.from,i=e.from,r=e.to,c=e.to,m=e.body,d=e.subject;var u="<br><br><br>===Previous Message===<br><br>";u+="From: "+n+"<br>",t.length>5&&(u+="Cc: "+t+"<br>"),a.length>5&&(u+="Bcc: "+a+"<br>");var p=new Date(1e3*e.date),h=p.getFullYear(),E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][p.getMonth()],f=p.getDate(),b=p.getHours(),g="0"+p.getMinutes();if(u+="Date: "+(p=f+"-"+E+"-"+h+" "+b+":"+g.substr(-2))+"<br>",u+="Subject: "+d+"<br>",u+="To: "+r+"<br><br><br>",u+=e.body,1===e.hasAttachments){u+="<hr><ul>";var v=0;for(v=0;v<e.attachment.length;v++)u+="<li><a href='"+window.location.origin+e.attachment[v].url+"' target='_blank'>"+e.attachment[v].file+"</a></li>";u+="</ul>"}l.setState({page:"email",subject:d,body:m,orFrom:i,from:n,orTo:c,to:r,orCc:s,cc:t,orBcc:o,bcc:a,date:p,busy:0,fwdMsg:u,uid:e.uid,messageId:e.messageId})}},l.closeEditors=function(){for(var e=l.state.thread,t=e.length,a=0;a<t;a++)e[a].editor=!1;l.setState({thread:e})},l.activeThread=function(e){for(var t=l.state.thread,a=t.length,n=0;n<a;n++)t[n].editor=!1;t[e].editor=!0,l.setEmailNode(t[e])},l.getRowIndex=function(e){for(var t=l.state.rows.length,a=0;a<t&&!(l.state.emailThreads[a].uids.indexOf(e)>=0);a++);return a},l.showSettings=function(){l.setState({page:"settings"})},l.showEmail=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var t=l.getRowIndex(e);window.scrollTo(0,0),l.setState({busy:1,rows:[]});var a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},n={folder:l.props.curFolder,thread_uids:l.state.emailThreads[t].uids,has_thread:1};G.a.post(window._api+"/email",n,a).then(function(e){200===e.status&&e.data.length>0?(l.setEmailNode(e.data[0]),l.setState({thread:e.data}),l.closeEditors()):(l.setState({page:"list"}),l.fetchEmails())})}},l.displayDate=function(e){var t=new Date(1e3*e),a=t.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],r=t.getDate(),l=t.getHours(),c="0"+t.getMinutes();return t=r+"-"+n+"-"+a+" "+l+":"+c.substr(-2),"".concat(t)},l.fetchEmails=function(){if(""!==l.props.curFolder&&void 0!==l.props.curFolder){l.setState({busy:1,rows:[]});var e={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},t={folder:l.props.curFolder,has_thread:1};G.a.post(window._api+"/emails",t,e).then(function(e){if(200===e.status){var t=[],a=[],n=0,r=l.props.curFolder;(r=r.toLowerCase()).search("starred")>0&&(n=1);for(var c=0;c<e.data.length;c++){var s=new Date(1e3*e.data[c].date),o=s.getFullYear(),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()],m=s.getDate()+"-"+i+"-"+o+" "+s.getHours()+":"+("0"+s.getMinutes()).substr(-2);e.data[c].hasAttachments;t[c]=Qe(e.data[c].uid,n,e.data[c].from,e.data[c].subject,0,0,m),a[c]=e.data[c].thread}t.length>0?l.setState({rows:t,emailThreads:a,busy:0}):l.setState({rows:"",emailThreads:[],busy:0})}})}},l.searchEmails=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){l.setState({busy:1,rows:[]});var t={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},a={curfolder:l.props.curFolder,sterm:e};G.a.post(window._api+"/search_emails",a,t).then(function(e){if(200===e.status){for(var t=[],a=[],n=0;n<e.data.length;n++){var r=new Date(e.data[n].date).toLocaleDateString("en-GB",{month:"numeric",day:"numeric",year:"numeric"});e.data[n].hasAttachments;t[n]=Qe(e.data[n].uid,0,e.data[n].from[0].mail,e.data[n].subject,0,0,r),a[n]=e.data[n].threads}t.length>0?l.setState({rows:t,emailThreads:a,busy:0}):l.setState({rows:"",emailThreads:a,busy:0})}})}},l.handleRefresh=function(){l.fetchEmails()},l.state={app:e.location.state,rows:[],cells:Ze,title:"",busy:1,modal:!1,modal_backdrop:!1,modal_nested_parent:!1,modal_nested:!1,backdrop:!0,page:"list",uid:"",orSubject:"",subject:"",body:"",to:"",orTo:"",orFrom:"",from:"",orCc:"",cc:"",orBcc:"",bcc:"",date:"",fwdMsg:"",content:"",attachmentContent:"",editor:!1,modalEditorState:re.EditorState.createEmpty(),isEmailFwd:!1,attachment:[],isEmailStarred:0,thread:[],emailThreads:[],messageId:"",enableMarkdown:!1,enableEmailThread:!1,dateFormat:"",dockState:"normal"},l}return Object(l.a)(a,[{key:"componentDidMount",value:function(){void 0!==this.props.location.state||this.props.history.push("/login")}},{key:"componentDidUpdate",value:function(e){if(this.props.curFolder!==e.curFolder&&(this.setState({page:"list",title:this.props.curFolder}),this.fetchEmails()),this.props.searchTerm!==e.searchTerm){this.setState({page:"list"});var t=this.props.searchTerm;this.searchEmails(t)}}},{key:"render",value:function(){return m.a.createElement(m.a.Fragment,null,m.a.createElement($.a,null,m.a.createElement(ae.a,null)),m.a.createElement(S,{className:"cm-inbox-page"},("list"===this.state.page||"list"===this.props.page)&&m.a.createElement(m.a.Fragment,null,0===this.state.rows.length&&0===this.state.busy&&m.a.createElement("p",{style:{padding:15}},"No emails found"),1===this.state.busy&&m.a.createElement("div",{className:"cr-page-spinner"},m.a.createElement(Q.a,{color:"danger",style:{width:"10rem",height:"10rem",marginTop:"10rem"}})," "),0!==this.state.rows.length&&m.a.createElement(m.a.Fragment,null,m.a.createElement(ee.a,{className:"email-refresh"},m.a.createElement("div",null,m.a.createElement(te.a,{onClick:this.showSettings},m.a.createElement(L.k,null)))),m.a.createElement(Y,{rows:this.state.rows,rowsLength:this.state.rows.length,headCells:this.state.cells,tableTitle:this.props.curFolder,labelRowsPerPage:"Per page",showEmptyRows:!1,props:this.props,showEmail:this.showEmail,trashEmail:this.trashEmail,untrashEmail:this.untrashEmail,starEmail:this.starEmail,spamEmail:this.spamEmail,unspamEmail:this.unspamEmail,breakpoint:this.props.breakpoint})),this.state.modal&&m.a.createElement(_e,{modal:this.state.modal,dockState:this.state.dockState,to:this.state.to,cc:this.state.cc,bcc:this.state.bcc,subject:this.state.subject,content:this.state.content,attachmentContent:this.state.attachmentContent,composehandler:this.handleCompose,closemodal:this.closeModal,resizeDock:this.resizeDock,classnm:this.props.className,sendemail:this.sendEmail,meditorstate:this.state.modalEditorState,meditorstatehandler:this.onModalEditorStateChange,attachmenthandler:this.handleAttachment,markdown:this.state.enableMarkdown})),0===this.state.busy&&"list"===this.state.page&&m.a.createElement(Z.Container,null,m.a.createElement(Z.Button,{tooltip:"Compose email",rotate:!1,onClick:this.handleCompose()},m.a.createElement(L.f,null))),"email"===this.state.page&&m.a.createElement(Ye,{breakpoint:this.state.breakpoint,thread:this.state.thread,setState:this.updateState,fetchEmails:this.fetchEmails,trashEmail:this.trashEmail,spamEmail:this.spamEmail,emailStarred:this.state.isEmailStarred,starEmail:this.starEmail,displayDate:this.displayDate,editor:this.state.editor,editorHandler:this.editorHandler,replyEmail:this.replyEmail,resetSubject:this.resetSubject,fwdMsg:this.state.fwdMsg,isEmailFwd:this.state.isEmailFwd,handleAttachment:this.handleAttachment,activeThread:this.activeThread,closeEditors:this.closeEditors,markdown:this.state.enableMarkdown}),"settings"===this.state.page&&m.a.createElement(Ge,{breakpoint:this.state.breakpoint,setState:this.updateState,fetchEmails:this.fetchEmails,markdown:this.state.enableMarkdown})))}}]),a}(m.a.Component);t.default=Object(K.a)($e)}}]);
//# sourceMappingURL=4.dd7fe492.chunk.js.map