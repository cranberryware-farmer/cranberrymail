(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{449:function(e,t,a){"use strict";a.r(t);var r=a(27),n=a(13),l=a(14),s=a(15),c=a(8),o=a(16),i=a(2),m=a.n(i),d=a(10),u=(a(20),a(26)),p=a(424),h=a(425),E=a(30),b=a(5),f=a.n(b),g={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6","display-1":"h1","display-2":"h1","display-3":"h1","display-4":"h1",p:"p",lead:"p",blockquote:"blockquote"},v=function(e){var t,a=e.tag,r=e.className,n=e.type,l=Object(d.a)(e,["tag","className","type"]),s=f()(Object(E.a)({},n,!!n),r);return t=a||(!a&&g[n]?g[n]:"p"),m.a.createElement(t,Object.assign({},l,{className:s}))};v.defaultProps={type:"p"};var w=v,y=u.a.create("page"),S=function(e){var t=e.title,a=e.breadcrumbs,r=e.tag,n=e.className,l=e.children,s=Object(d.a)(e,["title","breadcrumbs","tag","className","children"]),c=y.b("px-3",n);return m.a.createElement(r,Object.assign({className:c},s),m.a.createElement("div",{className:y.e("header")},t&&"string"===typeof t?m.a.createElement(w,{type:"h1",className:y.e("title")},t):t,a&&m.a.createElement(p.a,{className:y.e("breadcrumb")},m.a.createElement(h.a,null,"Home"),a.length&&a.map(function(e,t){var a=e.name,r=e.active;return m.a.createElement(h.a,{key:t,active:r},a)}))),l)};S.defaultProps={tag:"div",title:""};var j=S,k=a(387),C=a(156),N=a(433),O=a(172),F=a(438),x=a(439),A=a(440),B=a(431),M=(a(426),a(447)),D=a(430),P=(a(453),a(434)),T=a(435),I=a(437),R=a(450),_=a(432),J=a(455),z=a(441),H=a(442),L=a(29);function q(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}var V=Object(N.a)(function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(O.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}}),W=function(e){var t=V(),a=e.numSelected,r=e.tableTitle,n=void 0!=r?r.toLowerCase():"";return m.a.createElement(P.a,{className:Object(C.a)(t.root,Object(E.a)({},t.highlight,a>0))},m.a.createElement("div",{className:t.title},a>0?m.a.createElement(T.a,{color:"inherit"},a," selected"):m.a.createElement(T.a,{id:"tableTitle"},r)),m.a.createElement("div",{className:t.spacer}),m.a.createElement("div",{className:t.actions},a>0&&m.a.createElement(m.a.Fragment,null,null===n.match("spam")?m.a.createElement(J.a,{title:"Mark as spam"},m.a.createElement(_.a,{"aria-label":"spam",onClick:function(){e.unselectAll(),e.spamEmails(e.rows)}},m.a.createElement(L.b,null))):m.a.createElement(J.a,{title:"Not Spam"},m.a.createElement(_.a,{"aria-label":"unspam",onClick:function(){e.unselectAll(),e.unspamEmails(e.rows)}},m.a.createElement(L.e,null))),null===n.match("trash")?m.a.createElement(J.a,{title:"Move to trash"},m.a.createElement(_.a,{"aria-label":"delete",onClick:function(){e.unselectAll(),e.trashEmails(e.rows)}},m.a.createElement(L.k,null))):m.a.createElement(m.a.Fragment,null,m.a.createElement(J.a,{title:"Delete emails"},m.a.createElement(_.a,{"aria-label":"delete",onClick:function(){e.unselectAll(),e.trashEmails(e.rows)}},m.a.createElement(L.k,null))),m.a.createElement(J.a,{title:"Restore emails"},m.a.createElement(_.a,{"aria-label":"undelete",onClick:function(){e.unselectAll(),e.untrashEmails(e.rows)}},m.a.createElement(L.l,null)))))))},U=Object(N.a)(function(e){return{root:{width:"100%"},paper:{width:"100%"},table:{minWidth:750},tableWrapper:{overflowX:"auto"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}),Y=m.a.memo(function(e){var t=e.rows,a=e.headCells,r=e.tableTitle,n=e.labelRowsPerPage,l=e.showEmptyRows,s=(e.props,e.showEmail),c=e.trashEmail,o=e.starEmail,d=e.untrashEmail,u=e.spamEmail,p=e.unspamEmail,h=e.breakpoint,E=U(),b=m.a.useState("desc"),f=Object(k.a)(b,2),g=f[0],v=(f[1],m.a.useState("id")),w=Object(k.a)(v,2),y=w[0],S=(w[1],m.a.useState([])),j=Object(k.a)(S,2),C=j[0],N=j[1],O=m.a.useState(0),P=Object(k.a)(O,2),T=P[0],_=P[1],J=m.a.useState(!1),L=Object(k.a)(J,2),V=L[0],Y=L[1],G=m.a.useState(30),X=Object(k.a)(G,2),K=X[0],Q=X[1];n=n||"Per page",l="undefined"==typeof l||l;var Z=function(e,t){s(t)},$=function(e,t){var a=C.indexOf(t),r=[];-1===a?r=r.concat(C,t):0===a?r=r.concat(C.slice(1)):a===C.length-1?r=r.concat(C.slice(0,-1)):a>0&&(r=r.concat(C.slice(0,a),C.slice(a+1))),N(r)},ee=function(e,t){e.preventDefault();var a=document.querySelector("#star-"+t).getAttribute("data-starred");o(t,"1"===a?0:1)},te=function(e,t){_(t)},ae=function(e){Q(+e.target.value),_(0)},re=K-Math.min(K,t.length-T*K);return Object(i.useEffect)(function(){"xs"===h&&Y(!0)}),m.a.createElement("div",{className:E.root},m.a.createElement(I.a,{className:E.paper},m.a.createElement(F.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",spacing:0,className:E.root,style:{borderBottom:"1px solid inherit"}},m.a.createElement(F.a,{item:!0,xs:!0,style:{paddingLeft:4}},m.a.createElement(R.a,{indeterminate:C.length>0&&C.length<t.length,checked:C.length===t.length,onChange:function(e){if(e.target.checked){var a=t.map(function(e){return e.id});N(a)}else N([])},inputProps:{"aria-label":"select all"}})),m.a.createElement(F.a,{item:!0,xs:!0},m.a.createElement(W,{numSelected:C.length,tableTitle:r,rows:C,trashEmails:c,unselectAll:function(e){N([])},untrashEmails:d,spamEmails:u,unspamEmails:p})),m.a.createElement(F.a,{item:!0,xs:!0},m.a.createElement(M.a,{rowsPerPageOptions:[30,50,100],labelRowsPerPage:n,component:"div",count:t.length,rowsPerPage:K,page:T,backIconButtonProps:{"aria-label":"previous page"},nextIconButtonProps:{"aria-label":"next page"},onChangePage:te,onChangeRowsPerPage:ae}))),m.a.createElement("div",{className:E.tableWrapper},m.a.createElement(x.a,{className:E.table,"aria-labelledby":"tableTitle",size:V?"small":"medium",striped:!0},m.a.createElement(A.a,null,function(e,t){var a=e.map(function(e,t){return[e,t]});return a.sort(function(e,a){var r=t(e[0],a[0]);return 0!==r?r:e[1]-a[1]}),a.map(function(e){return e[0]})}(t,function(e,t){return"desc"===e?function(e,a){return q(e,a,t)}:function(e,a){return-q(e,a,t)}}(g,y)).slice(T*K,T*K+K).map(function(e,t){var a,r=(a=e.id,-1!==C.indexOf(a)),n="enhanced-table-checkbox-".concat(t);return"xs"===h?m.a.createElement(m.a.Fragment,null,m.a.createElement(D.a,{hover:!0,role:"checkbox","aria-checked":r,tabIndex:-1,key:e.id,selected:r,className:"hl-tr"},m.a.createElement(B.a,{padding:"checkbox",onClick:function(t){return $(0,e.id)},rowSpan:5},m.a.createElement(R.a,{checked:r,inputProps:{"aria-labelledby":n}}))),Object.keys(e).map(function(t,a){if("id"!==t){if("starred"===t){var r=m.a.createElement(B.a,null,m.a.createElement("span",{id:"star-"+e.id,onClick:function(t){return ee(t,e.id)},"data-starred":e[t],className:"starred"},1===e[t]?"\u2605":"\u2606"));return m.a.createElement(D.a,null,r)}if("subject"===t){var n=m.a.createElement(B.a,{onClick:function(t){return Z(0,e.id)}},e[t].substr(0,30),"...");return m.a.createElement(D.a,null,n)}if("attachment"!==t){if("timestamp"===t){var l=e[t].split(" ");l=l[0];var s=m.a.createElement(B.a,{onClick:function(t){return Z(0,e.id)}},l);return m.a.createElement(D.a,null,s)}var c=m.a.createElement(B.a,{onClick:function(t){return Z(0,e.id)}},m.a.createElement("strong",null,e[t]));return m.a.createElement(D.a,null,c)}}return null})):m.a.createElement(D.a,{hover:!0,role:"checkbox","aria-checked":r,tabIndex:-1,key:e.id,selected:r,className:"hl-tr"},m.a.createElement(B.a,{padding:"checkbox",onClick:function(t){return $(0,e.id)},rowSpan:1},m.a.createElement(R.a,{checked:r,inputProps:{"aria-labelledby":n}})),Object.keys(e).map(function(t,a){if("id"!==t){if("starred"===t)return m.a.createElement(B.a,null,m.a.createElement("span",{id:"star-"+e.id,onClick:function(t){return ee(t,e.id)},"data-starred":e[t],className:"starred"},1===e[t]?"\u2605":"\u2606"));if("subject"===t)return m.a.createElement(B.a,{onClick:function(t){return Z(0,e.id)}},e[t].substr(0,40),"...");if("attachment"!==t){if("timestamp"===t){var r=e[t];return m.a.createElement(B.a,{onClick:function(t){return Z(0,e.id)}},r)}return m.a.createElement(B.a,{onClick:function(t){return Z(0,e.id)}},e[t])}}return null}))}),re>0&&l&&m.a.createElement(D.a,{key:"t1",style:{height:(V?33:53)*re}},m.a.createElement(B.a,{colSpan:a.length+1}))))),m.a.createElement(M.a,{rowsPerPageOptions:[30,50,100],labelRowsPerPage:n,component:"div",count:t.length,rowsPerPage:K,page:T,backIconButtonProps:{"aria-label":"previous page"},nextIconButtonProps:{"aria-label":"next page"},onChangePage:te,onChangeRowsPerPage:ae})),m.a.createElement(z.a,{control:m.a.createElement(H.a,{checked:V,onChange:function(e){Y(e.target.checked)}}),label:"Dense padding"}))}),G=a(23),X=a.n(G),K=a(152),Q=a(145),Z=a(284),$=a(146),ee=a(131),te=a(126),ae=a(31),re=(a(43),a(274)),ne=a(182),le=a(267),se=a.n(le),ce=(a(268),a(147)),oe=a(136),ie=a(132),me=a(452),de=a(443),ue=a(444),pe=a(121),he=a(122),Ee=a(123),be=a(124),fe=a(445),ge=a(11),ve=a(269),we=function(e){return m.a.createElement($.a,null,m.a.createElement(ce.a,{md:"12",sm:"12",xs:"12"},m.a.createElement(ee.a,null,m.a.createElement(oe.a,null,"Modal"),m.a.createElement(ie.a,null,m.a.createElement(me.a,{isOpen:e.modal,toggle:function(){e.closemodal()},className:e.classnm},m.a.createElement(de.a,{toggle:function(){e.closemodal()}},"Compose Email"),m.a.createElement(ue.a,null,m.a.createElement(pe.a,{onSubmit:function(){e.sendemail()}},m.a.createElement(he.a,null,m.a.createElement(Ee.a,{for:"to"},"To"),m.a.createElement(be.a,{type:"text",name:"to",id:"to",placeholder:"Send email to...",required:!0}),m.a.createElement(fe.a,{color:"muted"}," Email addresses to be separated by ,")),m.a.createElement(he.a,null,m.a.createElement(Ee.a,{for:"cc"},"Cc"),m.a.createElement(be.a,{type:"text",name:"text",id:"cc",placeholder:"Send copy of email to..."}),m.a.createElement(fe.a,{color:"muted"}," Email addresses to be separated by ,")),m.a.createElement(he.a,null,m.a.createElement(Ee.a,{for:"bcc"},"Bcc"),m.a.createElement(be.a,{type:"text",name:"bcc",id:"bcc",placeholder:"Send copy of email to..."}),m.a.createElement(fe.a,{color:"muted"}," Email addresses to be separated by ,")),m.a.createElement(he.a,null,m.a.createElement(Ee.a,{for:"subject"},"Subject"),m.a.createElement(be.a,{type:"text",name:"subject",id:"subject",placeholder:"Subject of the email"})),m.a.createElement(he.a,null,m.a.createElement(Ee.a,{for:"email"},"Email"),m.a.createElement(ve.Editor,{editorState:e.meditorstate,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:function(t){e.meditorstatehandler(t)},id:"email",toolbarClassName:"toolbar-class",toolbar:{inline:{inDropdown:!0},list:{inDropdown:!0},textAlign:{inDropdown:!0},link:{inDropdown:!0},history:{inDropdown:!0}}})),m.a.createElement(he.a,null,m.a.createElement(Ee.a,{for:"attachment"},m.a.createElement(ge.a,null)," Attachment"),m.a.createElement(be.a,{type:"file",name:"attachment",id:"attachment",multiple:"multiple",onChange:function(t){e.attachmenthandler(t)}}),m.a.createElement(fe.a,{color:"muted"},"Maximum allowed file size 20MB")),m.a.createElement(te.a,{onClick:function(){return e.sendemail()}},"Send Email"))))))))},ye=a(143),Se=a(386);function je(e){return function(){var t,a=Object(c.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var r=Object(c.a)(this).constructor;t=Reflect.construct(a,arguments,r)}else t=a.apply(this,arguments);return Object(s.a)(this,t)}}var ke=function(e){Object(o.a)(a,e);var t=je(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e)).state={editorState:ne.EditorState.createEmpty(),isCc:!1,isBcc:!1},r.onEditorStateChange=function(e){r.setState({editorState:e})};var l={};if(r.props.markdown){var s=r.props.fwdMsg,c=Object(re.b)(s);l=Object(ne.convertFromRaw)(c)}else l=Object(Se.a)(r.props.fwdMsg);var o=ne.EditorState.createWithContent(l);return r.state={editorState:o},r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){!0===this.props.isEmailFwd&&(document.getElementById("staticEmail").value="",this.state.isCc&&(document.getElementById("cc").value=""),this.state.isBcc&&(document.getElementById("bcc").value="")),this.props.orCc.length>0&&!1===this.state.isCc&&this.setState({isCc:!0}),this.props.orBcc.length>0&&!1===this.state.isBcc&&this.setState({isBcc:!0})}},{key:"render",value:function(){var e=this,t=this.state.editorState;return m.a.createElement("div",null,m.a.createElement("div",null,m.a.createElement(pe.a,null,m.a.createElement(he.a,{row:!0},m.a.createElement(Ee.a,{for:"staticEmail",sm:2},"To"),m.a.createElement(ce.a,{sm:10},m.a.createElement(be.a,{type:"text",className:"form-control-plaintext border-bottom",id:"staticEmail",defaultValue:this.props.orFrom,placeholder:"To"}),m.a.createElement(fe.a,{color:"muted"}," Email addresses to be separated by ,"))),this.state.isCc?m.a.createElement(he.a,{row:!0},m.a.createElement(Ee.a,{for:"cc",sm:2},"Cc"),m.a.createElement(ce.a,{sm:10},m.a.createElement(be.a,{type:"text",className:"form-control-plaintext border-bottom",id:"cc",placeholder:"Cc",defaultValue:this.props.isEmailFwd?"":this.props.orCc}),m.a.createElement(fe.a,{color:"muted"}," Email addresses to be separated by ,"))):m.a.createElement("a",{href:"#cc",onClick:function(){e.setState({isCc:!0})}},"CC"),m.a.createElement("span",null,"\xa0"),this.state.isBcc?m.a.createElement(he.a,{row:!0},m.a.createElement(Ee.a,{for:"bcc",sm:2},"Bcc"),m.a.createElement(ce.a,{sm:10},m.a.createElement(be.a,{label:"Bcc",type:"text",className:"form-control-plaintext border-bottom",id:"bcc",placeholder:"Bcc",defaultValue:this.props.isEmailFwd?"":this.props.orBcc}),m.a.createElement(fe.a,{color:"muted"}," Email addresses to be separated by ,"))):m.a.createElement("a",{href:"#bcc",onClick:function(){e.setState({isBcc:!0})}},"BCC"),m.a.createElement(he.a,{row:!0},m.a.createElement(Ee.a,{for:"subject",sm:2},"Subject"),m.a.createElement(ce.a,{sm:10},m.a.createElement(be.a,{type:"text",label:"subject",className:"form-control-plaintext border-bottom",id:"subject",placeholder:"Subject",defaultValue:this.props.isEmailFwd?"Fwd: "+this.props.subject:"Re: "+this.props.subject}))))),m.a.createElement("span",null,"\xa0"),m.a.createElement(ve.Editor,{editorState:t,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:this.onEditorStateChange,placeholder:"Type your mail here...",toolbarClassName:"toolbar-class",toolbar:{inline:{inDropdown:!0},list:{inDropdown:!0},textAlign:{inDropdown:!0},link:{inDropdown:!0},history:{inDropdown:!0}}}),m.a.createElement("div",null,"  ",m.a.createElement(ge.a,null)," \xa0 ",m.a.createElement("input",{type:"file",name:"attachment",id:"attachment",multiple:!0,onChange:function(t){e.props.handleAttachment(t)}}),m.a.createElement("p",{className:"text-muted"},"Maximum allowed file size 20MB")),m.a.createElement(te.a,{className:"mr-2",onClick:function(){var a={},r=t.getCurrentContent();a=e.props.markdown?Object(re.a)(Object(ne.convertToRaw)(r)):se()(Object(ne.convertToRaw)(r)),e.props.replyEmail(a)}},"Send"),m.a.createElement(te.a,{onClick:function(){document.getElementById("attachment").value="",e.props.editor(),e.props.resetSubject(),e.props.closeEditors()}},m.a.createElement(L.k,null)))}}]),a}(i.Component),Ce=function(e){var t="float-right";return"xs"===e.breakpoint&&(t="float-left i-block"),m.a.createElement($.a,{className:"email-pg"},m.a.createElement(ce.a,{xl:9,lg:9,md:9,xs:9},e.thread.map(function(a,r){var n=a.body;if(1===a.hasAttachments){n+="<hr><p>Attachments:</p><ul>";for(var l=window.location.pathname,s=l.split("/"),c=s.pop();"cmail"!==c;)c=s.pop();l=s.join("/");for(var o=0;o<a.attachment.length;o++)n+="<li><a href='"+l+a.attachment[o].url+"' target='_blank' download>"+a.attachment[o].file+"</a></li>";n+="</ul>"}return m.a.createElement(m.a.Fragment,{key:a.uid},m.a.createElement(ee.a,{className:"mt-3"},m.a.createElement(oe.a,null,m.a.createElement("div",{className:"clearfix"},m.a.createElement(ye.a,{to:"#url",title:"Back to mailbox",onClick:function(t){t.preventDefault(),e.setState({page:"list"}),e.fetchEmails()},className:"email-icons float-left"},m.a.createElement(L.a,null)),m.a.createElement("span",{className:"eml-subject float-left"},a.subject),m.a.createElement(ye.a,{to:"#",className:"email-icons ".concat(t),title:"Delete email",onClick:function(t){t.preventDefault();var r=a.uid;e.trashEmail(r),e.setState({page:"list"}),e.fetchEmails()}},m.a.createElement(L.k,null)),m.a.createElement(ye.a,{to:"#",className:"email-icons ".concat(t),title:"Mark email as spam",onClick:function(t){t.preventDefault();var r=a.uid;e.spamEmail(r),e.setState({page:"list"}),e.fetchEmails()}},m.a.createElement(L.b,null)),m.a.createElement(ye.a,{to:"#",title:e.emailStarred?"Unmark as starred":"Mark as starred",onClick:function(t){t.preventDefault();var r=a.uid,n=0;n=1===e.emailStarred?0:1,e.setState({isEmailStarred:n}),e.starEmail(r,n)},className:"email-icons ".concat(t)},e.emailStarred?m.a.createElement(L.h,null):m.a.createElement(L.g,null))),m.a.createElement("div",{className:"clearfix"},m.a.createElement("span",{className:"float-left eml-from"},a.from),m.a.createElement("span",{className:"".concat(t)},e.displayDate(a.date)))),m.a.createElement(ie.a,{dangerouslySetInnerHTML:{__html:"".concat(n)}})),m.a.createElement(ee.a,{className:"mt-3"},m.a.createElement(ie.a,null,m.a.createElement($.a,{className:"editor-container"},a.editor?m.a.createElement(ce.a,{xs:"auto"},m.a.createElement(ke,{className:"ql-editor",editor:e.editorHandler,from:a.from,cc:a.cc,bcc:a.bcc,subject:a.subject,replyEmail:e.replyEmail,resetSubject:e.resetSubject,orFrom:a.from,orCc:a.cc,orBcc:a.bcc,to:a.to,orTo:a.to,uid:a.uid,fwdMsg:e.fwdMsg,isEmailFwd:e.isEmailFwd,handleAttachment:function(t){e.handleAttachment(t)},closeEditors:e.closeEditors,markdown:e.markdown})):m.a.createElement($.a,null,m.a.createElement("div",{className:"ml-3"},m.a.createElement(te.a,{className:"ml-3",onClick:function(){e.activeThread(r);var t=a.subject;e.setState({editor:!0,orSubject:t,subject:t,isEmailFwd:!1})}},"Reply")),m.a.createElement("div",{className:"ml-3"},m.a.createElement(te.a,{className:"ml-3",onClick:function(){e.activeThread(r);var t=a.subject;e.setState({editor:!0,orSubject:t,subject:t,isEmailFwd:!0})}},"Forward")))))))})))},Ne=a(446),Oe=function(e){var t=e.markdown;return m.a.createElement($.a,{className:"email-pg"},m.a.createElement(ce.a,{xl:9,lg:9,md:9,xs:9},m.a.createElement(ee.a,{className:"mt-3"},m.a.createElement(oe.a,null,"Settings"),m.a.createElement(ie.a,null,m.a.createElement(Ne.a,{type:"switch",id:"markdown",name:"markdown",label:"Enable Markdown",onChange:function(e){t=e.target.checked},defaultChecked:e.markdown}),m.a.createElement("br",null),m.a.createElement(te.a,{onClick:function(){e.setState({enableMarkdown:t,page:"list"}),e.fetchEmails()}},"Save")))))};function Fe(e){return function(){var t,a=Object(c.a)(e);if(function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var r=Object(c.a)(this).constructor;t=Reflect.construct(a,arguments,r)}else t=a.apply(this,arguments);return Object(s.a)(this,t)}}function xe(e,t,a,r,n,l,s){return{id:e,starred:t,from:a,subject:r,timestamp:s}}var Ae=[{id:"starred",numeric:!0,disablePadding:!1,label:""},{id:"from",numeric:!1,disablePadding:!1,label:"From"},{id:"subject",numeric:!1,disablePadding:!1,label:"Subject"},{id:"timestamp",numeric:!1,disablePadding:!1,label:"Date"}],Be=function(e){Object(o.a)(a,e);var t=Fe(a);function a(e){var l;return Object(n.a)(this,a),(l=t.call(this,e)).handleAttachment=function(e){var t=e.target.files;l.setState({attachment:t})},l.updateState=function(e){l.setState(Object(r.a)({},e))},l.onModalEditorStateChange=function(e){l.setState({modalEditorState:e})},l.editorHandler=function(){l.setState({editor:!1})},l.resetSubject=function(){l.setState({subject:l.state.orSubject})},l.replyEmail=function(e){var t={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},a=e,r=document.getElementById("cc"),n=document.getElementById("bcc"),s=document.getElementById("staticEmail").value,c=document.getElementById("subject").value,o=l.state.messageId,i={};if(l.state.attachment){i=new FormData;for(var m=0,d=l.state.attachment;m<d.length;m++)i.append("attachment[]",d[m]);i.append("to",s),i.append("subject",c),i.append("body",a),i.append("messageId",o),null!==r&&i.append("cc",r.value),null!==n&&i.append("cc",n.value),t.headers["Content-Type"]="multipart/form-data"}else i={to:s,subject:c,body:a,messageId:o},null!==r&&(i.cc=r.value),null!==n&&(i.bcc=n.value);X.a.post(window._api+"/smtp/sendEmail",i,t).then(function(e){e.data.result>0?(l.editorHandler(),l.setState({attachment:!1}),Object(ae.b)("Email has been sent"),l.resetSubject(),l.closeEditors()):Object(ae.b)(e.data.message)})},l.starEmail=function(e,t){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},r={curFolder:l.props.curFolder,uid:e,emailState:t,trashFolder:"trash",starredFolder:"starred"};X.a.post(window._api+"/star_emails",r,a).then(function(a){if(a.data.result>0){if(0===t?Object(ae.b)("Email moved to Inbox"):Object(ae.b)("Email moved to Starred"),"list"===l.state.page){var r=l.state.rows;r=r.filter(function(t){return t.id!==e}),l.setState({rows:r})}}else 0===t?Object(ae.b)("Email still marked as starred"):Object(ae.b)("Unable to mark email as starred")})}},l.untrashEmail=function(e){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var r=l.state.rows;e.sort();var n=0;r=r.filter(function(t){return t.id!==e[n]||(n++,!1)}),l.setState({rows:r}),e=JSON.stringify(e),t=1}var s={curfolder:"inbox",trash:"trash",uid:e};X.a.post(window._api+"/untrash_emails",s,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails have been restored"):Object(ae.b)("Email has been restored"))})},l.trashEmail=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var r=l.state.rows;e.sort();var n=0;r=r.filter(function(t){return t.id!==e[n]||(n++,!1)}),l.setState({rows:r}),e=JSON.stringify(e),t=1}var s={curfolder:l.props.curFolder,trash:"trash",uid:e};X.a.post(window._api+"/trash_emails",s,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails have been deleted"):Object(ae.b)("Email has been deleted"))})}},l.spamEmail=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var r=l.state.rows;e.sort();var n=0;r=r.filter(function(t){return t.id!==e[n]||(n++,!1)}),l.setState({rows:r}),e=JSON.stringify(e),t=1}var s={curfolder:l.props.curFolder,spam:"spam",uid:e};X.a.post(window._api+"/spam_emails",s,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails marked as spam"):Object(ae.b)("Email marked as spam"))})}},l.unspamEmail=function(e){var t=0,a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}};if(Array.isArray(e)){var r=l.state.rows;e.sort();var n=0;r=r.filter(function(t){return t.id!==e[n]||(n++,!1)}),l.setState({rows:r}),e=JSON.stringify(e),t=1}var s={curfolder:"inbox",spam:"spam",uid:e};X.a.post(window._api+"/unspam_emails",s,a).then(function(e){e.data.result>0&&(1===t?Object(ae.b)("Emails have been restored"):Object(ae.b)("Email has been restored"))})},l.sendEmail=function(e){var t={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},a={},r=l.state.modalEditorState.getCurrentContent();a=l.state.enableMarkdown?Object(re.a)(Object(ne.convertToRaw)(r)):se()(Object(ne.convertToRaw)(r));var n=document.getElementById("cc"),s=document.getElementById("bcc"),c=document.getElementById("to").value,o=document.getElementById("subject").value,i={};if(l.state.attachment){var m=0;i=new FormData;for(var d=l.state.attachment;m<d.length;m++)i.append("attachment[]",d[m]);i.append("to",c),i.append("subject",o),i.append("body",a),null!==n&&i.append("cc",n.value),null!==s&&i.append("bcc",s.value),t.headers["Content-Type"]="multipart/form-data"}else i={to:c,subject:o,body:a},null!==n&&(i.cc=n.value),null!==s&&(i.bcc=s.value);X.a.post(window._api+"/smtp/sendEmail",i,t).then(function(e){e.data.result>0?(l.resetFields(),l.setState({modal:!1}),Object(ae.b)("Email has been sent")):Object(ae.b)(e.data.message)})},l.resetFields=function(){document.getElementById("to")&&(document.getElementById("to").value="",document.getElementById("cc").value="",document.getElementById("bcc").value="",document.getElementById("subject").value="",document.getElementById("attachment").value="",l.setState({modalEditorState:ne.EditorState.createEmpty(),attachment:!1}))},l.handleCompose=function(e){return function(){e||(l.setState({modal:!l.state.modal}),l.resetFields())}},l.closeModal=function(){l.setState({modal:!1})},l.setEmailNode=function(e){var t="",a="",r="",n="",s="",c="",o="",i="",m="",d="";if(e){t=e.cc,c=e.cc,a=e.bcc,o=e.bcc,r=e.from,i=e.from,n=e.to,s=e.to,m=e.body,d=e.subject;var u="<br><br><br>===Previous Message===<br><br>";u+="From: "+r+"<br>",t.length>5&&(u+="Cc: "+t+"<br>"),a.length>5&&(u+="Bcc: "+a+"<br>");var p=new Date(1e3*e.date),h=p.getFullYear(),E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][p.getMonth()],b=p.getDate(),f=p.getHours(),g="0"+p.getMinutes();if(u+="Date: "+(p=b+"-"+E+"-"+h+" "+f+":"+g.substr(-2))+"<br>",u+="Subject: "+d+"<br>",u+="To: "+n+"<br><br><br>",u+=e.body,1===e.hasAttachments){u+="<hr><ul>";var v=0;for(v=0;v<e.attachment.length;v++)u+="<li><a href='"+window.location.origin+e.attachment[v].url+"' target='_blank'>"+e.attachment[v].file+"</a></li>";u+="</ul>"}l.setState({page:"email",subject:d,body:m,orFrom:i,from:r,orTo:s,to:n,orCc:c,cc:t,orBcc:o,bcc:a,date:p,busy:0,fwdMsg:u,uid:e.uid,messageId:e.messageId})}},l.closeEditors=function(){for(var e=l.state.thread,t=e.length,a=0;a<t;a++)e[a].editor=!1;l.setState({thread:e})},l.activeThread=function(e){for(var t=l.state.thread,a=t.length,r=0;r<a;r++)t[r].editor=!1;t[e].editor=!0,l.setEmailNode(t[e])},l.getRowIndex=function(e){for(var t=l.state.rows.length,a=0;a<t&&!(l.state.emailThreads[a].uids.indexOf(e)>=0);a++);return a},l.showSettings=function(){l.setState({page:"settings"})},l.showEmail=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){var t=l.getRowIndex(e);window.scrollTo(0,0),l.setState({busy:1,rows:[]});var a={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},r={folder:l.props.curFolder,thread_uids:l.state.emailThreads[t].uids,has_thread:1};X.a.post(window._api+"/email",r,a).then(function(e){200===e.status&&e.data.length>0?(l.setEmailNode(e.data[0]),l.setState({thread:e.data}),l.closeEditors()):(l.setState({page:"list"}),l.fetchEmails())})}},l.displayDate=function(e){var t=new Date(1e3*e),a=t.getFullYear(),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],n=t.getDate(),l=t.getHours(),s="0"+t.getMinutes();return t=n+"-"+r+"-"+a+" "+l+":"+s.substr(-2),"".concat(t)},l.fetchEmails=function(){if(""!==l.props.curFolder&&void 0!==l.props.curFolder){l.setState({busy:1,rows:[]});var e={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},t={folder:l.props.curFolder,has_thread:1};X.a.post(window._api+"/emails",t,e).then(function(e){if(200===e.status){var t=[],a=[],r=0,n=l.props.curFolder;(n=n.toLowerCase()).search("starred")>0&&(r=1);for(var s=0;s<e.data.length;s++){var c=new Date(1e3*e.data[s].date),o=c.getFullYear(),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][c.getMonth()],m=c.getDate()+"-"+i+"-"+o+" "+c.getHours()+":"+("0"+c.getMinutes()).substr(-2);e.data[s].hasAttachments;t[s]=xe(e.data[s].uid,r,e.data[s].from,e.data[s].subject,0,0,m),a[s]=e.data[s].thread}t.length>0?l.setState({rows:t,emailThreads:a,busy:0}):l.setState({rows:"",emailThreads:[],busy:0})}})}},l.searchEmails=function(e){if(""!==l.props.curFolder||void 0!==l.props.curFolder){l.setState({busy:1,rows:[]});var t={headers:{Accept:"application/json",Authorization:"Bearer "+l.state.app.token}},a={curfolder:l.props.curFolder,sterm:e};X.a.post(window._api+"/search_emails",a,t).then(function(e){if(200===e.status){for(var t=[],a=[],r=0;r<e.data.length;r++){var n=new Date(e.data[r].date).toLocaleDateString("en-GB",{month:"numeric",day:"numeric",year:"numeric"});e.data[r].hasAttachments;t[r]=xe(e.data[r].uid,0,e.data[r].from[0].mail,e.data[r].subject,0,0,n),a[r]=e.data[r].threads}t.length>0?l.setState({rows:t,emailThreads:a,busy:0}):l.setState({rows:"",emailThreads:a,busy:0})}})}},l.handleRefresh=function(){l.fetchEmails()},l.state={app:e.location.state,rows:[],cells:Ae,title:"",busy:1,modal:!1,modal_backdrop:!1,modal_nested_parent:!1,modal_nested:!1,backdrop:!0,page:"list",uid:"",orSubject:"",subject:"",body:"",to:"",orTo:"",orFrom:"",from:"",orCc:"",cc:"",orBcc:"",bcc:"",date:"",fwdMsg:"",editor:!1,modalEditorState:ne.EditorState.createEmpty(),isEmailFwd:!1,attachment:[],isEmailStarred:0,thread:[],emailThreads:[],messageId:"",enableMarkdown:!1,enableEmailThread:!1,dateFormat:""},l}return Object(l.a)(a,[{key:"componentDidMount",value:function(){void 0!==this.props.location.state||this.props.history.push("/login")}},{key:"componentDidUpdate",value:function(e){if(this.props.curFolder!==e.curFolder&&(this.setState({page:"list",title:this.props.curFolder}),this.fetchEmails()),this.props.searchTerm!==e.searchTerm){this.setState({page:"list"});var t=this.props.searchTerm;this.searchEmails(t)}}},{key:"render",value:function(){return m.a.createElement(m.a.Fragment,null,m.a.createElement($.a,null,m.a.createElement(ae.a,null)),m.a.createElement(j,{className:"cm-inbox-page"},("list"===this.state.page||"list"===this.props.page)&&m.a.createElement(m.a.Fragment,null,0===this.state.rows.length&&0===this.state.busy&&m.a.createElement("p",{style:{padding:15}},"No emails found"),1===this.state.busy&&m.a.createElement("div",{className:"cr-page-spinner"},m.a.createElement(Q.a,{color:"danger",style:{width:"10rem",height:"10rem",marginTop:"10rem"}})," "),0!==this.state.rows.length&&m.a.createElement(m.a.Fragment,null,m.a.createElement(ee.a,{className:"email-refresh"},m.a.createElement("div",null,m.a.createElement(te.a,{onClick:this.showSettings},m.a.createElement(L.j,null)))),m.a.createElement(Y,{rows:this.state.rows,rowsLength:this.state.rows.length,headCells:this.state.cells,tableTitle:this.props.curFolder,labelRowsPerPage:"Per page",showEmptyRows:!1,props:this.props,showEmail:this.showEmail,trashEmail:this.trashEmail,untrashEmail:this.untrashEmail,starEmail:this.starEmail,spamEmail:this.spamEmail,unspamEmail:this.unspamEmail,breakpoint:this.props.breakpoint})),this.state.modal&&m.a.createElement(we,{modal:this.state.modal,composehandler:this.handleCompose,closemodal:this.closeModal,classnm:this.props.className,sendemail:this.sendEmail,meditorstate:this.state.modalEditorState,meditorstatehandler:this.onModalEditorStateChange,attachmenthandler:this.handleAttachment,markdown:this.state.enableMarkdown})),0===this.state.busy&&"list"===this.state.page&&m.a.createElement(Z.Container,null,m.a.createElement(Z.Button,{tooltip:"Compose email",rotate:!1,onClick:this.handleCompose()},m.a.createElement(L.f,null))),"email"===this.state.page&&m.a.createElement(Ce,{breakpoint:this.state.breakpoint,thread:this.state.thread,setState:this.updateState,fetchEmails:this.fetchEmails,trashEmail:this.trashEmail,spamEmail:this.spamEmail,emailStarred:this.state.isEmailStarred,starEmail:this.starEmail,displayDate:this.displayDate,editor:this.state.editor,editorHandler:this.editorHandler,replyEmail:this.replyEmail,resetSubject:this.resetSubject,fwdMsg:this.state.fwdMsg,isEmailFwd:this.state.isEmailFwd,handleAttachment:this.handleAttachment,activeThread:this.activeThread,closeEditors:this.closeEditors,markdown:this.state.enableMarkdown}),"settings"===this.state.page&&m.a.createElement(Oe,{breakpoint:this.state.breakpoint,setState:this.updateState,fetchEmails:this.fetchEmails,markdown:this.state.enableMarkdown})))}}]),a}(m.a.Component);t.default=Object(K.a)(Be)}}]);
//# sourceMappingURL=4.1aea6b96.chunk.js.map